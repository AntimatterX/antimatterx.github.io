/*! CmdExt v2.0.1 | (c) AntimatterX | https://opensource.org/licenses/MIT */
!function e(t,r){"use strict";var n={libKey:[],conflict:{},fn:{noConflict:function(){for(var e=0;e<n.libKey.length;e++){var r=n.libKey[e];r in n.conflict&&(t[r]=n.conflict[r])}return n.conflict},getType:function(e){return Object.prototype.toString.call(e).slice(8,-1)},isType:function(e,t){var r=n.fn.getType(e);switch(n.fn.getType(t)){case"String":return r===t;case"RegExp":return t.test(r);case"Array":return t.indexOf(r)>-1;default:return!1}},castType:function(e,t,r){return n.fn.isType(e,n.fn.isType(r,"RegExp")?r:[n.fn.getType(t)].concat(n.fn.isType(r,"Array")?r:"string"==typeof r?[r]:[]))?e:t},castParam:function(e,t,r){e=n.fn.castType(e,{}),t=n.fn.castType(t,{});var a=Object.keys(t);r=function(){switch(n.fn.getType(r)){case"String":case"RegExp":case"Array":for(var e={},t=0;t<a.length;t++)e[a[t]]=r;return e;default:return n.fn.castType(r,{})}}();for(var o=function(){for(var t={},r=Object.keys(e),n=0;n<r.length;n++)t[r[n]]=e[r[n]];return t}(),s=0;s<a.length;s++){var i=a[s];o[i]=i in e?n.fn.castType(e[i],t[i],n.fn.castType(r[i],[],["String","RegExp"])):t[i]}return o}}},a={key:"CmdExt",val:function(){function e(t){if(!(this instanceof e))return new e(t);t=e._castParam(t,{separator:"",quots:[],commands:{},caseInsensitive:!1},{quots:"String"}),this.separator=/^\S+$/.test(t.separator)?t.separator:".",this.quots=e._initQuots(t.quots),this.commands=t.commands,this.caseInsensitive=t.caseInsensitive,this._handlers={commanderror:[],commandnotfound:[],disabledcommand:[]}}var t;return e.prototype._getType=e._getType=n.fn.getType,e.prototype._isType=e._isType=n.fn.isType,e.prototype._castType=e._castType=n.fn.castType,e.prototype._castParam=e._castParam=n.fn.castParam,e.prototype._escapeRegExp=e._escapeRegExp=function(e){return("string"==typeof e?e:"").replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")},e.prototype._initQuots=e._initQuots=function(t){return(e._isType(t,"Array")?t.concat(Array.prototype.slice.call(arguments,1)):Array.prototype.slice.call(arguments)).slice().filter(function(e,t,r){return r.indexOf(e)===t&&"string"==typeof e&&/^\S+$/.test(e)}).map(function(t){return e._escapeRegExp(t)}).sort(function(e,t){return t.length-e.length})},e.parseArg=function(t,r){var n="string"==typeof t&&t.length>0?t.split("").reverse().join(""):"",a="(?:("+e._initQuots.apply(null,Array.prototype.slice.call(arguments,1)).join("|")+")(?!\\\\))",o=[];if("(?:()(?!\\\\))"!==a&&new RegExp(a).test(n))for(var s,i=new RegExp("(?:^|\\s+)"+a+"[\\s\\S]*?\\1(?:$|\\s+)|\\S+","g");null!==(s=i.exec(n));)o.push(s[0].trim());else o=n.match(/\S+/g)||[];return o.reverse().map(function(e){return e.replace(new RegExp("^"+a+"([\\s\\S]*?)\\1$"),"$2").replace(/([^\\]+)\\/g,"$1").split("").reverse().join("")})},e.prototype.errors=e.errors=((t={}).CommandError=function(){function e(t){if(!(this instanceof e))return new e(t);var r=new Error(t);return r.name="CommandError",Object.setPrototypeOf(r,Object.getPrototypeOf(this)),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(r,e),r}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(e,Error),e}(),t.CommandNotFound=function(){function e(r){if(!(this instanceof e))return new e(r);var n=new t.CommandError(r);return n.name="CommandNotFound",Object.setPrototypeOf(n,Object.getPrototypeOf(this)),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(n,e),n}return e.prototype=Object.create(t.CommandError.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(e,t.CommandError),e}(),t.DisabledCommand=function(){function e(r){if(!(this instanceof e))return new e(r);var n=new t.CommandError(r);return n.name="DisabledCommand",Object.setPrototypeOf(n,Object.getPrototypeOf(this)),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(n,e),n}return e.prototype=Object.create(t.CommandError.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(e,t.CommandError),e}(),t),e.prototype._trigger=function(e,t){if(e in this._handlers)for(var r=0;r<this._handlers[e].length;r++)"function"==typeof this._handlers[e][r]&&this._handlers[e][r].apply(null,Array.prototype.slice.call(arguments,1));return this},e.prototype._addHandler=function(e,t){return e in this._handlers&&"function"==typeof t&&this._handlers[e].push(t),this},e.prototype._getPath=function(t){return""===t?[t]:(t="string"==typeof t?t:"").length<1?[]:this.caseInsensitive?t.replace(new RegExp(e._escapeRegExp(this.separator),"ig"),function(e){return e.toLowerCase()}).split(this.separator.toLowerCase()):t.split(this.separator)},e.prototype.parseArg=function(t){return e.parseArg(t,this.quots)},e.prototype.parseCommand=function(e){var t=(e="string"==typeof e?e:"").match(/^(\S+)(?:\s+([\s\S]*))?$/)||[];return{_matchResult:t.length>0?t:null,isCommand:this.has(t[1]||""),text:e,pathname:t[1]||"",path:this._getPath(t[1]||""),argname:t[2]||"",args:this.parseArg(t[2]||"")}},e.prototype.get=function(t){for(var n=this._getPath(t),a=this.commands,o=[],s=0;s<n.length;s++){for(var i={},c=Object.keys(a),p=0;p<c.length;p++){if(i[u=c[p]]=u,e._isType(a[u].aliases,"Array"))for(var l=0;l<a[u].aliases.length;l++)i[a[u].aliases[l]]=u}var u;if((u=i[((" "+Object.keys(i).join(" ")+" ").match(new RegExp(" ("+e._escapeRegExp(n[s])+") "),this.caseInsensitive?"i":r)||[])[1]])===r)return;var m=e._castParam(a[u],{aliases:[],callback:null,subcommands:null,enabled:!1},{callback:"Function",subcommands:"Object"});m.commandName=u,m.parent=o[s-1]||null,m.raw={parent:((m.parent||{}).raw||{}).command||null,command:a[u]},m.enabled="function"==typeof a[u].callback&&"boolean"==typeof a[u].enabled?a[u].enabled:"function"==typeof a[u].callback,o.push(m),e._isType(a[u].subcommands,"Object")&&(a=a[u].subcommands)}return o.pop()},e.prototype.set=function(t,n){var a=this._getPath(t);if(a.length>0){for(var o=0;o<a.length;o++){var s=a.slice(0,o),i=this.get(a.slice(0,o+1).join(this.separator)),c=((this.get(s.join(this.separator))||{}).raw||{}).command||this.commands;if(i===r){c===this.commands||e._isType(c.subcommands,"Object")||(c.subcommands={});var p=c===this.commands?c:c.subcommands;p[a[o]]={},a[o+1]!==r&&(p[a[o]].subcommands={})}}n=e._castType(n,{});var l=this.get(t).raw.command,u=Object.keys(n);for(o=0;o<u.length;o++)l[u[o]]=n[u[o]]}return this},e.prototype.delete=function(e){var t=this.get(e);return t!==r&&delete((((t.parent||{}).raw||{}).command||{}).subcommands||this.commands)[t.commandName]},e.prototype.has=function(e){return this.get(e)!==r},e.prototype.exec=function(t){var n=this.parseCommand(t),a=this.get(n.pathname),o={cmdext:this,text:t,args:n.args,error:a===r?new e.errors.CommandNotFound("Command '"+n.pathname+"' is not found"):a.enabled?null:new e.errors.DisabledCommand("Command '"+n.pathname+"' is disabled"),failed:a===r||a!==r&&!a.enabled,parseData:n,command:a};if(o.failed&&this._trigger("commanderror",o),a===r||!a.enabled){if(this._handlers.commanderror.length<1&&(a===r&&this._handlers.commandnotfound.length<1||!a.enabled&&this._handlers.disabledcommand.length<1))throw err;this._trigger(a===r?"commandnotfound":"disabledcommand",o)}return this},e.prototype.on=function(t,r){switch(e._getType(t)){case"String":for(var n=t.match(/\S+/g)||[],a=0;a<n.length;a++)this._addHandler(n[a],r);break;case"Object":var o=Object.keys(t);for(a=0;a<o.length;a++)this._addHandler(o[a],t[o[a]])}return this},e}()};if(n.libKey=n.fn.castType(a.key,[a.key]),"object"==typeof module&&"object"==typeof module.exports&&null!==module.exports)module.exports=a.val;else for(var o=0;o<n.libKey.length;o++){var s=n.libKey[o];s in t&&(n.conflict[s]=t[s]),t[s]=a.val}return{_root:t,undefined:r,_main:e,_ctx:n,_lib:a}}("object"==typeof window?window:this);
