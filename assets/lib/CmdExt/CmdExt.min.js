/*! CmdExt v2.0.0 | (c) AntimatterX | https://opensource.org/licenses/MIT */
!function t(e,r){"use strict";var n={libKey:[],conflict:{},fn:{noConflict:function(){for(var t=0;t<n.libKey.length;t++){var r=n.libKey[t];r in n.conflict&&(e[r]=n.conflict[r])}return n.conflict},getType:function(t){return Object.prototype.toString.call(t).slice(8,-1)},isType:function(t,e){var r=n.fn.getType(t);switch(n.fn.getType(e)){case"String":return r===e;case"RegExp":return e.test(r);case"Array":return e.indexOf(r)>-1;default:return!1}},castType:function(t,e,r){return n.fn.isType(t,n.fn.isType(r,"RegExp")?r:[n.fn.getType(e)].concat(n.fn.isType(r,"Array")?r:"string"==typeof r?[r]:[]))?t:e},castParam:function(t,e,r){t=n.fn.castType(t,{}),e=n.fn.castType(e,{});var a=Object.keys(e);r=function(){switch(n.fn.getType(r)){case"String":case"RegExp":case"Array":for(var t={},e=0;e<a.length;e++)t[a[e]]=r;return t;default:return n.fn.castType(r,{})}}();for(var o=function(){for(var e={},r=Object.keys(t),n=0;n<r.length;n++)e[r[n]]=t[r[n]];return e}(),s=0;s<a.length;s++){var i=a[s];o[i]=i in t?n.fn.castType(t[i],e[i],n.fn.castType(r[i],[],["String","RegExp"])):e[i]}return o}}},a={key:"CmdExt",val:function(){function t(e){if(!(this instanceof t))return new t(e);e=t._castParam(e,{separator:"",quots:[],commands:{},caseInsensitive:!1},{quots:"String"}),this.separator=/^\S+$/.test(e.separator)?e.separator:".",this.quots=t._initQuots(e.quots),this.commands=e.commands,this.caseInsensitive=e.caseInsensitive,this._handlers={commanderror:[],commandnotfound:[],disabledcommand:[]}}var e;return t.prototype._getType=t._getType=n.fn.getType,t.prototype._isType=t._isType=n.fn.isType,t.prototype._castType=t._castType=n.fn.castType,t.prototype._castParam=t._castParam=n.fn.castParam,t.prototype._escapeRegExp=t._escapeRegExp=function(t){return("string"==typeof t?t:"").replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")},t.prototype._initQuots=t._initQuots=function(e){return(t._isType(e,"Array")?e.concat(Array.prototype.slice.call(arguments,1)):Array.prototype.slice.call(arguments)).slice().filter(function(t,e,r){return r.indexOf(t)===e&&"string"==typeof t&&/^\S+$/.test(t)}).map(function(e){return t._escapeRegExp(e)}).sort(function(t,e){return e.length-t.length})},t.parseArg=function(e,r){var n="string"==typeof e&&e.length>0?e.split("").reverse().join(""):"",a="(?:("+t._initQuots.apply(null,Array.prototype.slice.call(arguments,1)).join("|")+")(?!\\\\))",o=[];if("(?:()(?!\\\\))"!==a&&new RegExp(a).test(n))for(var s,i=new RegExp("(?:^|\\s+)"+a+"[\\s\\S]*?\\1(?:$|\\s+)|\\S+","g");null!==(s=i.exec(n));)o.push(s[0].trim());else o=n.match(/\S+/g)||[];return o.reverse().map(function(t){return t.replace(new RegExp("^"+a+"([\\s\\S]*?)\\1$"),"$2").replace(/([^\\]+)\\/g,"$1").split("").reverse().join("")})},t.prototype.errors=t.errors=((e={}).CommandError=function(){function t(e){if(!(this instanceof t))return new t(e);var r=new Error(e);return r.name="CommandError",Object.setPrototypeOf(r,Object.getPrototypeOf(this)),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(r,t),r}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(t,Error),t}(),e.CommandNotFound=function(){function t(r){if(!(this instanceof t))return new t(r);var n=new e.CommandError(r);return n.name="CommandNotFound",Object.setPrototypeOf(n,Object.getPrototypeOf(this)),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(n,t),n}return t.prototype=Object.create(e.CommandError.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(t,e.CommandError),t}(),e.DisabledCommand=function(){function t(r){if(!(this instanceof t))return new t(r);var n=new e.CommandError(r);return n.name="DisabledCommand",Object.setPrototypeOf(n,Object.getPrototypeOf(this)),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(n,t),n}return t.prototype=Object.create(e.CommandError.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(t,e.CommandError),t}(),e),t.prototype._trigger=function(t,e){if(t in this._handlers)for(var r=0;r<this._handlers[t].length;r++)"function"==typeof this._handlers[t][r]&&this._handlers[t][r].apply(null,Array.prototype.slice.call(arguments,1));return this},t.prototype._addHandler=function(t,e){return t in this._handlers&&"function"==typeof e&&this._handlers[t].push(e),this},t.prototype._getPath=function(e){return""===e?[e]:(e="string"==typeof e?e:"").length<1?[]:this.caseInsensitive?e.replace(new RegExp(t._escapeRegExp(this.separator),"ig"),function(t){return t.toLowerCase()}).split(this.separator.toLowerCase()):e.split(this.separator)},t.prototype.parseArg=function(e){return t.parseArg(e,this.quots)},t.prototype.parseCommand=function(t){var e=(t="string"==typeof t?t:"").match(/^(\S+)(?:\s+([\s\S]*))?$/)||[];return{_matchResult:e.length>0?e:null,isCommand:this.has(e[1]||""),text:t,pathname:e[1]||"",path:this._getPath(e[1]||""),argname:e[2]||"",args:this.parseArg(e[2]||"")}},t.prototype.get=function(e){for(var n=this._getPath(e),a=this.commands,o=[],s=0;s<n.length;s++){for(var i={},c=Object.keys(a),p=0;p<c.length;p++){if(i[u=c[p]]=u,t._isType(a[u].aliases,"Array"))for(var l=0;l<a[u].aliases.length;l++)i[a[u].aliases[l]]=u}var u;if((u=i[((" "+Object.keys(i).join(" ")+" ").match(new RegExp(" ("+t._escapeRegExp(n[s])+") "),this.caseInsensitive?"i":r)||[])[1]])===r)return;var m=t._castParam(a[u],{aliases:[],callback:null,subcommands:null,enabled:!1},{callback:"Function",subcommands:"Object"});m.commandName=u,m.parent=o[s-1]||null,m.raw={parent:((m.parent||{}).raw||{}).command||null,command:a[u]},m.enabled="function"==typeof a[u].callback&&"boolean"==typeof a[u].enabled?a[u].enabled:"function"==typeof a[u].callback,o.push(m),t._isType(a[u].subcommands,"Object")&&(a=a[u].subcommands)}return o.pop()},t.prototype.set=function(e,n){var a=this._getPath(e);if(a.length>0){for(var o=0;o<a.length;o++){var s=a.slice(0,o),i=this.get(a.slice(0,o+1).join(this.separator)),c=((this.get(s.join(this.separator))||{}).raw||{}).command||this.commands;if(i===r){c===this.commands||t._isType(c.subcommands,"Object")||(c.subcommands={});var p=c===this.commands?c:c.subcommands;p[a[o]]={},a[o+1]!==r&&(p[a[o]].subcommands={})}}n=t._castType(n,{});var l=this.get(e).raw.command,u=Object.keys(n);for(o=0;o<u.length;o++)l[u[o]]=n[u[o]]}return this},t.prototype.delete=function(t){var e=this.get(t);return e!==r&&delete((((e.parent||{}).raw||{}).command||{}).subcommands||this.commands)[e.commandName]},t.prototype.has=function(t){return this.get(t)!==r},t.prototype.exec=function(e){var n=this.parseCommand(e),a=this.get(n.pathname),o={cmdext:this,text:e,args:n.args,error:null,failed:a===r||a!==r&&!a.enabled,parseData:n,command:a};if(o.failed&&this._trigger("commanderror",o),a===r||!a.enabled){var s=a===r?new t.errors.CommandNotFound("Command '"+n.pathname+"' is not found"):new t.errors.DisabledCommand("Command '"+n.pathname+"' is disabled");if(this._handlers.commanderror.length<1&&(a===r&&this._handlers.commandnotfound.length<1||!a.enabled&&this._handlers.disabledcommand.length<1))throw s;o.error=s,this._trigger(a===r?"commandnotfound":"disabledcommand",o)}return this},t.prototype.on=function(e,r){switch(t._getType(e)){case"String":for(var n=e.match(/\S+/g)||[],a=0;a<n.length;a++)this._addHandler(n[a],r);break;case"Object":var o=Object.keys(e);for(a=0;a<o.length;a++)this._addHandler(o[a],e[o[a]])}return this},t}()};if(n.libKey=n.fn.castType(a.key,[a.key]),"object"==typeof module&&"object"==typeof module.exports&&null!==module.exports)module.exports=a.val;else for(var o=0;o<n.libKey.length;o++){var s=n.libKey[o];s in e&&(n.conflict[s]=e[s]),e[s]=a.val}return{_root:e,undefined:r,_main:t,_ctx:n,_lib:a}}("object"==typeof window?window:this);
